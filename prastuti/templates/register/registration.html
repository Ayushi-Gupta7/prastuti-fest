{% extends 'base.html' %}

{% block body_block %}
<form action="" method="post">
{% csrf_token %}
<form method="POST" action="{% url 'event_registration:register' event %}">
    {{form.errors}}
    <label for="team_size">Choose the team size: </label>
    <select name="team_size" id="size" onchange="emailField()">
        <option value="0">---</option>
        {% for i in allowed_team_sizes %}
            <option value="{{i}}">{{i}}</option>
        {% endfor %}
    </select>
    {% if error_message %}
    <b>{{error_message}}</b>
    {% endif %}
    <div id = "emails">
    </div>
</form>

<script>
function emailField(){
    var lst = parseInt(document.getElementById("size").value)
    console.log(lst)
    var emails = document.getElementById("emails")
    while (emails.firstChild) {
        emails.removeChild(emails.lastChild);
    }
    var lab = document.createElement("label")
    lab.innerHTML = "Team Name"
    var name = document.createElement("input")
    name.setAttribute("type",'text')
    name.setAttribute("name","team_name")
    emails.appendChild(lab)
    emails.appendChild(name)
    for(var i = 1; i <= lst; i++){
        var node = document.createElement("div")
        var label = document.createElement("label")
        label.innerHTML = "Email ID of Member #" + i;
        var field = document.createElement("input")
        field.setAttribute('type',"email");
        field.setAttribute('name','email' + i);
        node.appendChild(label);
        node.appendChild(field);
        emails.appendChild(node);
    }
    var but = document.createElement("button")
    but.setAttribute("value","Submit")
    but.innerHTML = "Submit"
    emails.appendChild(but)
}
</script>

{% endblock %}